import{o,c as n,t as l,u as i,_ as S,a as g,b as w,r as y,d as _,w as h,F as C,e as M,n as f,f as T,g as a,h as d,i as U,j as N,T as A,s as b,p as B,k as G}from"./index-BMd-QA-V.js";import O from"./ImageFile-SGnJshYu.js";import{C as L}from"./regex-CP_ygsHJ.js";const D={class:"text-truncate simple-message"},I={__name:"MessageItemSimple",props:["item"],setup(r){return(t,u)=>(o(),n("div",D,l(r.item.content.replace(i(L).TAG.ALL_TAG,".")),1))}},m=r=>(B("data-v-37ea5021"),r=r(),G(),r),$=["id"],F={class:"d-flex"},V={class:"flex-grow-0 chat-user-img align-self-center me-2 ms-0"},j={class:"avatar-sm"},z=["src"],P={class:"flex-fill"},q={class:"d-flex"},H={class:"flex-grow-1 overflow-hidden"},J={class:"text-truncate mt-1 mb-0 fw-bold"},K={class:"ms-auto me-1"},Q=["onClick"],W={key:0},X=m(()=>a("i",{class:"ri ri-pushpin-2-fill active"},null,-1)),Y=[X],Z={key:1},ss=m(()=>a("i",{class:"ri ri-pushpin-line"},null,-1)),ts=[ss],es={key:0,class:"d-flex"},os={key:0,class:"message-room text-muted flex-fill flex-grow-1 text-truncate"},as={key:1,class:"text-muted flex-shrink-0"},cs={__name:"RoomList",props:["keyword"],setup(r){const t=g(),u=r,p=function(e){return t.chat.MEMBER[e.id+"_"+t.chat.CURRENT_USER.id]?e.total-t.chat.MEMBER[e.id+"_"+t.chat.CURRENT_USER.id].position:0},E=function(e){for(const c in t.chat.CONTACT)t.chat.USER[c]&&t.chat.CONTACT[c].room_id===e.id&&(e.name=t.chat.USER[c].name,e.icon=t.chat.USER[c].avatar);return"Direct"},v=async function(e){(await t.updateRoom(e.id,{pin:!e.pin})).success&&b({icon:"success",title:"Pin room "+e.name+" success"})},k=w(()=>{if(t.rooms)return t.rooms.filter(e=>(e.type===3&&E(e),e.name.includes(u.keyword))).sort((e,c)=>new Date(c.updated_at).valueOf()-new Date(e.updated_at).valueOf()).sort((e,c)=>c.pin-e.pin)});return(e,c)=>{const x=y("router-link");return o(),_(A,{tag:"ul",name:"fade",class:"list-unstyled chat-list chat-user-list border-top",id:"userList"},{default:h(()=>[(o(!0),n(C,null,M(i(k),(s,R)=>(o(),n("li",{key:R,id:"room-item-"+s.id,class:f({active:s.id===i(t).chat.CURRENT_ROOM.id})},[T(x,{to:"/chat/rid-"+s.id,class:"p-2"},{default:h(()=>[a("div",F,[a("div",V,[a("div",j,[s.icon?(o(),_(O,{key:0,img_id:s.icon,class:"rounded-circle img-fluid userprofile"},null,8,["img_id"])):(o(),n("img",{key:1,class:"rounded-circle img-fluid userprofile",src:s.icon?s.icon:"https://ui-avatars.com/api/?name="+s.name},null,8,z))])]),a("div",P,[a("div",q,[a("div",H,[a("p",J,l(s.name),1)]),a("div",K,[p(s)>0?(o(),n("span",{key:0,class:f(["border border-success text-success unread-badge",{"bg-success text-white":i(t).chat.MEMBER[s.id+"_"+i(t).chat.CURRENT_USER.id].mention>0}])},l(p(s)),3)):d("",!0)]),a("div",{class:"flex-shrink-0 overflow-hidden room-pin",onClick:U(ns=>v(s),["prevent","stop"])},[s.pin?(o(),n("span",W,Y)):(o(),n("span",Z,ts))],8,Q)]),i(t).chat.MESSAGE[s.id+"_"+s.total]?(o(),n("div",es,[s.total>0?(o(),n("span",os,[i(t).chat.MESSAGE[s.id+"_"+s.total]?(o(),_(I,{key:0,item:i(t).chat.MESSAGE[s.id+"_"+s.total]},null,8,["item"])):d("",!0)])):d("",!0),s.total>0?(o(),n("span",as,l(i(N).time(i(t).chat.MESSAGE[s.id+"_"+s.total].updated_at)),1)):d("",!0)])):d("",!0)])])]),_:2},1032,["to"])],10,$))),128))]),_:1})}}},ls=S(cs,[["__scopeId","data-v-37ea5021"]]);export{ls as default};
